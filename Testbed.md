# Testbed

A physical testing environment was set up to enable the execution
of generated flight paths on the drones. This consisted of the drones
and their peripherals, sensors for positioning, as well as the testbed
which the simulated DSMs were executed over.

## Crazyflie 2.1 Drones
To execute the generated drone sensing missions on hardware, a fleet
of 4 Bitcraze Crazyflie 2.1 drones were used.

## Positioning
For positioning, two base stations of the Bitcraze
[Lighthouse V2 positioning system](https://www.bitcraze.io/documentation/system/positioning/ligthouse-positioning-system/) (based on the Steam VR 2.0
base stations) were placed on mounts approximately 2m above the
ground in opposite corners of the testing area. These worked in
conjunction with [lighthouse positioning decks](https://www.bitcraze.io/products/lighthouse-positioning-deck/) attached to the
drones themselves to provide accurate positioning of the drones. 

The base stations work by emitting a laser which periodically sweeps
across the area in front of it. The lighthouse positioning deck on
the drone is then able to detect these lasers and the angle that the
signals are received from, and use readings of this from multiple
base stations to calculate its position in the testing area. The
lighthouse base stations have an effective range of 6m, 150 degree
horizontal view, and 110 degree vertical view.

## Control
Bitcraze Crazyradio PAs were used to connect to
the drones from laptops, after which commands could be passed to
the drones via the Crazyswarm python library. Code was written to
translate EPOS generated paths into instructions for the crazyswarm
API so that the drones could navigate accordingly. The crazyswarm
API also has an extra advantage of having an option to simulate
the execution of commands in a software simulation of the drones,
which allowed for the testing of generated paths before risking
damaging the hardware. We were also able to simulate much larger
testing environments than we could use in real life, allowing us to
evaluate how our the effectiveness of our CDCA systems scaled
with this.

## Testbed
When executing DSM paths on hardware, the drones
flew above a physical testbed which builds off of the testbed pro-
posed by Qin et al. Our testbed consisted of a 2x3 grid of 2D
cells marked on the ground in the centre of the area between the
two lighthouse base stations. Each cell measured 55x47cm, and the
drones were flown at a height of 0.5m above the ground. To simulate
the information to be collected by the drones in their sensing mis-
sions, a 75" TV screen was laid on the ground facing upwards with
this grid marked on it. A video of traffic moving in a city viewed
from an static aerial viewpoint was played on the screen to simulate
a dynamic environment beneath the drones. A clear protective sheet
was placed over the screen to prevent damage from the drones, and
wireless charging decks were placed each corner of the testbed to
act as the base stations from which the drones take off and land.

## Drone Camera 
In order to simulate the completion of a sens-
ing mission above the testbed, the drones can be equiped with the
Bitcraze AI deck. This provides a 320x320 monochrome camera
which can be used to stream a video feed to a connected device. The
camera on the AI deck faces horizontally, however as the drones
are flown above the testbed then this means that the camera cannot
see the testbed without modifications. To solve this, we attached a
small lightweight mirror at a 45 degree angle in front of the camera
of the AI deck, which allowed the camera to view the testbed below.
We were able to use the AI deck camera to take several pictures
of the testbed from different heights while holding the drones and
verify that the testbed could be seen.

## Wireless chargers
When executing DSMs generated by EPOS in our system, the drones
start and end their path at base stations on the ground. To simu-
late the recharging of drones between sensing missions, we placed
wireless charging pads at the locations of the base stations in our
system. These were used in conjunction with the Bitcraze Qi wire-
less charging decks attached to the drones to allow the drones to
recharge while at the base stations.

## References
[Lighthouse V2 positioning system](https://www.bitcraze.io/documentation/system/positioning/ligthouse-positioning-system/)  
[lighthouse positioning decks](https://www.bitcraze.io/products/lighthouse-positioning-deck/)  
Chuhao Qin, Fethi Candan, Lyudmila S. Mihaylova, and Evangelos Pournaras. 3, 2, 1, drones go! a testbed to take off uav swarm intelligence for distributed sensing. https://arxiv.org/abs/2208.05914, 2022. Accessed: 2024-05-02.
